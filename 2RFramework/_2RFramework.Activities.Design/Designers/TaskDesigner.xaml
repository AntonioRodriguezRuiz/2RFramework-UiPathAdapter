<sap:ActivityDesigner x:Class="_2RFramework.Activities.Design.Designers.TaskDesigner"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:sa="http://schemas.microsoft.com/netfx/2009/xaml/activities"
    xmlns:p="clr-namespace:_2RFramework.Activities.Design.Properties"
    xmlns:sharedres="clr-namespace:UiPath.Shared.Localization"
    xmlns:sap="clr-namespace:System.Activities.Presentation;assembly=System.Activities.Presentation"
    xmlns:sapv="clr-namespace:System.Activities.Presentation.View;assembly=System.Activities.Presentation"
    xmlns:converters="clr-namespace:UiPath.Shared.Activities.Design.Converters"
    xmlns:uip="clr-namespace:UiPath.Shared.Activities.Design.Controls"
    xmlns:sys="clr-namespace:System;assembly=mscorlib">

 
    <sap:ActivityDesigner.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="..\Themes\Generic.xaml" />
            </ResourceDictionary.MergedDictionaries>
            <converters:ActivityIconConverter x:Key="ActivityIconConverter" />
            <Style x:Key="WorkflowItemsPresenterStyle" TargetType="sap:WorkflowItemsPresenter">
                <Setter Property="SpacerTemplate">
                    <Setter.Value>
                        <DataTemplate>
                            <Border Background="Transparent">
                                <Path Data="F1M181.297,177.841L181.205,177.746 181.385,177.563 202.804,156.146 202.804,135.07 178.497,159.373 170.847,167.026 170.666,167.205 163.107,159.653 138.804,135.345 138.804,156.42 160.219,177.841 170.76,188.379 181.297,177.841z" 
                      Stretch="Uniform" Fill="#FFDEDDDD" 
                      Width="15" Height="15" Margin="0,0,0,0" RenderTransformOrigin="0.5,0.5"/>
                            </Border>

                        </DataTemplate>
                    </Setter.Value>
                </Setter>
                <Setter Property="ItemsPanel">
                    <Setter.Value>
                        <ItemsPanelTemplate >
                            <StackPanel  Orientation="Vertical"/>
                        </ItemsPanelTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
        </ResourceDictionary>
    </sap:ActivityDesigner.Resources>
 
    <sap:ActivityDesigner.Icon>
        <DrawingBrush Stretch="Uniform" Drawing="{Binding Path=ModelItem, Converter={StaticResource ActivityIconConverter}, ConverterParameter=pack://application:\,\,\,/_2RFramework.Activities.Design;component/themes/icons.xaml}" />
    </sap:ActivityDesigner.Icon>
 
    <uip:ActivityDecoratorControl Style="{StaticResource ActivityDecoratorStyle}">
        <DockPanel LastChildFill="True">
            <!-- Add TaskName property -->
            <Grid DockPanel.Dock="Top" Margin="5">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                
                <TextBlock Grid.Column="0" Text="Task Name:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                <sapv:ExpressionTextBox Grid.Column="1" 
                                       OwnerActivity="{Binding Path=ModelItem}"
                                       Expression="{Binding Path=ModelItem.TaskName}"
                                       ExpressionType="{x:Type sys:String}"
                                       HintText="Enter task name..."/>
            </Grid>

            <Separator DockPanel.Dock="Top" Margin="0,5"/>
            
            <!-- Use a WorkflowItemsPresenter to show multiple activities -->
            <sap:WorkflowItemsPresenter x:Uid="sap:WorkflowItemsPresenter_Activities"
                                    AutomationProperties.AutomationId="ActivitiesCollection"
                                    Style="{StaticResource WorkflowItemsPresenterStyle}"
                                    AllowDrop="True"
                                    Items="{Binding Path=ModelItem.Activities, Mode=TwoWay}"
                                    AllowedItemType="{x:Type sa:Activity}"
                                    HintText="Drop Activities Here" />
        </DockPanel>
    </uip:ActivityDecoratorControl>
</sap:ActivityDesigner>
